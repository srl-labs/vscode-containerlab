<!-- Network Editor Panel -->
<div
  class="panel panel-overlay panel-editor fixed bottom-10 left-20 w-[420px] max-h-[600px] overflow-y-hidden overflow-x-hidden z-[21] draggable-panel"
  id="panel-network-editor"
  style="display: none"
>
  <p class="panel-heading">Network Editor</p>

  <div class="panel-block">
    <div class="p-2 max-h-[420px] overflow-y-auto">
      <div class="space-y-3">
        <!-- Basic Information Section -->
        <div class="border-b pb-3 mb-3" style="border-color: var(--vscode-panel-border)">
          <!-- Network Name -->
          <div class="form-group">
            <label class="block vscode-label mb-1">Network Name</label>
            <div>
              <span
                id="panel-network-editor-id"
                class="text-base px-2 py-1 inline-block rounded"
                style="
                  background-color: var(--vscode-textBlockQuote-background);
                  border: 1px solid var(--vscode-textBlockQuote-border);
                "
              ></span>
            </div>
          </div>

          <!-- Network Type -->
          <div class="form-group">
            <label class="block vscode-label mb-1">Network Type</label>
            <div id="panel-network-type-dropdown-container">
              <!-- Filterable dropdown will be inserted here -->
            </div>
          </div>

          <!-- Interface -->
          <div class="form-group">
            <label class="block vscode-label mb-1">Interface</label>
            <input type="text" class="input-field w-full" id="panel-network-interface" />
          </div>

          <!-- Validation Errors -->
          <div
            id="panel-network-validation-errors"
            class="p-2 rounded bg-[var(--vscode-inputValidation-errorBackground)] border border-[var(--vscode-inputValidation-errorBorder)]"
            style="display: none"
          >
            <div class="text-[var(--vscode-editorError-foreground)] text-sm font-semibold">
              Please fix the following errors:
            </div>
            <ul
              id="panel-network-validation-errors-list"
              class="text-[var(--vscode-editorError-foreground)] text-xs mt-1 list-disc list-inside"
            ></ul>
          </div>
        </div>
        <!-- Extended Properties Section -->
        <div class="vscode-section-header mb-2">Extended Properties</div>

        <!-- MAC Address (for single endpoint connections) -->
        <div class="form-group" id="panel-network-mac-section">
          <label class="block vscode-label mb-1">MAC Address</label>
          <input
            type="text"
            class="input-field w-full"
            id="panel-network-mac"
            placeholder="e.g., 02:42:ac:11:00:01"
          />
        </div>

        <!-- MTU (all types) -->
        <div class="form-group">
          <label class="block vscode-label mb-1">MTU</label>
          <input
            type="number"
            class="input-field w-full"
            id="panel-network-mtu"
            placeholder="1500"
          />
        </div>

        <!-- Macvlan Mode (only for macvlan) -->
        <div class="form-group" id="panel-network-mode-section" style="display: none">
          <label class="block vscode-label mb-1">Mode</label>
          <select class="input-field w-full" id="panel-network-mode">
            <option value="bridge">bridge (default)</option>
            <option value="private">private</option>
            <option value="vepa">vepa</option>
            <option value="passthru">passthru</option>
            <option value="source">source</option>
          </select>
        </div>

        <!-- VXLAN fields (only for vxlan/vxlan-stitch) -->
        <div id="panel-network-vxlan-section" style="display: none">
          <div class="form-group">
            <label class="block vscode-label mb-1">
              Remote IP
              <span class="text-[var(--vscode-editorError-foreground)]">*</span>
            </label>
            <input
              type="text"
              class="input-field w-full"
              id="panel-network-remote"
              placeholder="10.0.0.1"
            />
          </div>
          <div class="form-group">
            <label class="block vscode-label mb-1">
              VNI
              <span class="text-[var(--vscode-editorError-foreground)]">*</span>
            </label>
            <input
              type="number"
              class="input-field w-full"
              id="panel-network-vni"
              placeholder="100"
            />
          </div>
          <div class="form-group">
            <label class="block vscode-label mb-1">
              UDP Port
              <span class="text-[var(--vscode-editorError-foreground)]">*</span>
            </label>
            <input
              type="number"
              class="input-field w-full"
              id="panel-network-udp-port"
              placeholder="4789"
            />
          </div>
        </div>

        <div id="panel-network-vars-placeholder"></div>

        <!-- Labels -->
        <div class="form-group">
          <label class="block vscode-label mb-1">Labels</label>
          <div id="panel-network-labels-container" class="space-y-2">
            <!-- Dynamic label entries will be added here -->
          </div>
          <button class="btn btn-small mt-2" onclick="addNetworkLabelEntry()">
            <i class="fas fa-plus mr-1"></i>
            Add Label
          </button>
        </div>
      </div>
    </div>
  </div>
  <div id="panel-network-footer-placeholder"></div>
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const varsTpl = document.getElementById("vars-section-template");
      const footerTpl = document.getElementById("editor-footer-template");
      if (varsTpl && footerTpl) {
        const varsFrag = varsTpl.content.cloneNode(true);
        const varsContainer = varsFrag.querySelector(".vars-container");
        const addBtn = varsFrag.querySelector(".add-var-btn");
        if (varsContainer) {
          varsContainer.id = "panel-network-vars-container";
        }
        if (addBtn) {
          addBtn.setAttribute("onclick", "addNetworkVarEntry()");
        }
        document.getElementById("panel-network-vars-placeholder")?.appendChild(varsFrag);

        const footerFrag = footerTpl.content.cloneNode(true);
        const saveBtn = footerFrag.querySelector(".editor-save-btn");
        const closeBtn = footerFrag.querySelector(".editor-close-btn");
        if (saveBtn) {
          saveBtn.id = "panel-network-editor-save-button";
        }
        if (closeBtn) {
          closeBtn.id = "panel-network-editor-close-button";
        }
        document.getElementById("panel-network-footer-placeholder")?.appendChild(footerFrag);
      }
    });
  </script>
</div>
