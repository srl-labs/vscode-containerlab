/**
 * Navbar Component for React TopoViewer
 */
import React from 'react';
import { useTopoViewer, DeploymentState } from '../../context/TopoViewerContext';

interface NavbarProps {
  onZoomToFit?: () => void;
  onToggleLayout?: () => void;
}

/**
 * Get deployment status display
 */
function getDeploymentDisplay(state: DeploymentState): { text: string; className: string } {
  if (state === 'deployed') {
    return { text: 'üü¢ Deployed', className: 'deployed' };
  }
  if (state === 'undeployed') {
    return { text: '‚ö™ Undeployed', className: 'undeployed' };
  }
  return { text: '‚ùì Unknown', className: '' };
}

export const Navbar: React.FC<NavbarProps> = ({ onZoomToFit, onToggleLayout }) => {
  const { state, toggleLock } = useTopoViewer();
  const deploymentDisplay = getDeploymentDisplay(state.deploymentState);

  return (
    <nav className="navbar" role="navigation" aria-label="main navigation">
      {/* Left: Logo + Title */}
      <div className="navbar-brand">
        <a
          href="https://containerlab.dev/"
          target="_blank"
          rel="noopener noreferrer"
          className="flex items-center"
        >
          <ContainerlabLogo className="navbar-logo" />
        </a>
        <div className="navbar-title pl-0">
          <span className="navbar-title-main">TopoViewer</span>
          <span className="navbar-title-sub">
            <span className={`mode-badge ${state.mode === 'view' ? 'viewer' : 'editor'}`}>
              {state.mode === 'view' ? 'viewer' : 'editor'}
            </span>
            <span className="font-light">¬∑ {state.labName || 'Unknown Lab'}</span>
          </span>
        </div>
      </div>

      {/* Center: Buttons */}
      <div className="navbar-buttons">
        {/* Lock/Unlock toggle - only show in edit mode */}
        {state.mode === 'edit' && (
          <NavButton
            icon={state.isLocked ? 'fa-lock' : 'fa-lock-open'}
            title={state.isLocked ? 'Unlock for Editing' : 'Lock Editing'}
            onClick={toggleLock}
            active={!state.isLocked}
          />
        )}
        <NavButton
          icon="fa-expand"
          title="Fit to Viewport"
          onClick={onZoomToFit}
        />
        <NavButton
          icon="fa-circle-nodes"
          title="Layout Manager"
          onClick={onToggleLayout}
        />
        <NavButton
          icon="fa-keyboard"
          title="Shortcuts"
          onClick={() => { /* placeholder for shortcuts modal */ }}
        />
        <NavButton
          icon="fa-circle-info"
          title="About TopoViewer"
          onClick={() => { /* placeholder for about panel */ }}
        />
      </div>

      {/* Right: Status */}
      <div className="flex items-center gap-2">
        <span className={`deployment-status ${deploymentDisplay.className}`}>
          {deploymentDisplay.text}
        </span>
      </div>
    </nav>
  );
};

/**
 * Navbar Button Component
 */
interface NavButtonProps {
  icon: string;
  title: string;
  onClick?: () => void;
  active?: boolean;
}

const NavButton: React.FC<NavButtonProps> = ({ icon, title, onClick, active }) => {
  return (
    <button
      className={`btn-icon ${active ? 'active' : ''}`}
      title={title}
      onClick={onClick}
    >
      <span className="inline-flex items-center justify-center text-xl">
        <i className={`fas ${icon}`}></i>
      </span>
    </button>
  );
};

/**
 * Containerlab Logo SVG Component
 */
const ContainerlabLogo: React.FC<{ className?: string }> = ({ className }) => (
  <svg
    viewBox="65.95092024539876 14.95884 118.48159509202453 127.34192"
    xmlns="http://www.w3.org/2000/svg"
    className={className}
  >
    <g transform="matrix(1 0 0 1 -79.26000213500001 -78.47828994999998)">
      <g>
        <g>
          <path
            fill="rgb(152,162,174)"
            transform="matrix(1 0 0 1 10.55200000000002 18.97864700000000)"
            d="M121.530000,224.900000Q118.818000,224.900000,117.330000,226.796000Q115.842000,228.668000,115.842000,232.364000Q115.842000,236.156000,117.330000,237.908000Q118.818000,239.636000,121.530000,239.636000Q122.322000,239.636000,122.970000,239.492000Q123.642000,239.348000,124.194000,239.132000Q124.746000,238.916000,125.178000,238.652000Q125.610000,238.388000,125.922000,238.148000L126.618000,239.228000Q125.802000,239.924000,124.458000,240.452000Q123.138000,240.980000,121.434000,240.980000Q117.762000,240.980000,116.010000,238.748000Q114.258000,236.516000,114.258000,232.364000Q114.258000,230.396000,114.690000,228.788000Q115.146000,227.156000,116.034000,226.004000Q116.946000,224.852000,118.290000,224.228000Q119.658000,223.580000,121.482000,223.580000Q122.466000,223.580000,123.282000,223.772000Q124.098000,223.964000,124.722000,224.252000Q125.346000,224.516000,125.778000,224.828000Q126.234000,225.116000,126.498000,225.356000L125.730000,226.436000Q125.130000,225.932000,124.098000,225.428000Q123.066000,224.900000,121.530000,224.900000Z"
          />
        </g>
        <g>
          <path
            fill="rgb(0,201,255)"
            transform="matrix(1 0 0 1 10.55200000000002 18.97864700000000)"
            d="M242.420000,222.720000L244.556000,222.720000L244.556000,240.720000L242.420000,240.720000Z"
          />
          <path
            fill="rgb(0,201,255)"
            transform="matrix(1 0 0 1 10.55200000000002 18.97864700000000)"
            d="M255.970000,235.130000Q255.946000,235.130000,255.658000,235.082000Q255.370000,235.034000,254.938000,235.010000Q254.506000,234.962000,254.002000,234.938000Q253.498000,234.890000,253.066000,234.890000Q252.298000,234.890000,251.746000,235.082000Q251.218000,235.274000,250.882000,235.610000Q250.546000,235.922000,250.378000,236.354000Q250.234000,236.786000,250.234000,237.290000Q250.234000,238.322000,250.906000,238.826000Q251.602000,239.330000,252.706000,239.330000Q253.306000,239.330000,253.882000,239.138000Q254.458000,238.946000,254.914000,238.610000Q255.394000,238.250000,255.682000,237.794000Q255.970000,237.314000,255.970000,236.738000ZM256.114000,240.722000L256.018000,239.378000Q255.466000,240.146000,254.410000,240.602000Q253.354000,241.034000,252.226000,241.034000Q251.506000,241.034000,250.786000,240.842000Q250.066000,240.650000,249.490000,240.218000Q248.914000,239.786000,248.530000,239.066000Q248.170000,238.346000,248.170000,237.290000Q248.170000,235.442000,249.370000,234.338000Q250.570000,233.234000,252.970000,233.234000Q253.354000,233.234000,253.834000,233.258000Q254.314000,233.282000,254.746000,233.330000Q255.178000,233.354000,255.514000,233.402000Q255.850000,233.426000,255.970000,233.450000L255.970000,232.706000Q255.970000,231.386000,255.178000,230.810000Q254.410000,230.234000,252.970000,230.234000Q251.674000,230.234000,250.762000,230.522000Q249.874000,230.810000,249.466000,231.050000L248.818000,229.538000Q249.034000,229.394000,249.418000,229.202000Q249.802000,229.010000,250.354000,228.842000Q250.930000,228.650000,251.650000,228.530000Q252.394000,228.410000,253.306000,228.410000Q255.490000,228.410000,256.762000,229.490000Q258.034000,230.546000,258.034000,232.586000L258.034000,240.722000Z"
          />
          <path
            fill="rgb(0,201,255)"
            transform="matrix(1 0 0 1 10.55200000000002 18.97864700000000)"
            d="M262.190000,222.720000L264.326000,222.720000L264.326000,230.208000Q264.422000,229.992000,264.686000,229.704000Q264.974000,229.392000,265.430000,229.104000Q265.886000,228.816000,266.510000,228.624000Q267.134000,228.408000,267.950000,228.408000Q269.270000,228.408000,270.254000,228.888000Q271.238000,229.368000,271.886000,230.208000Q272.534000,231.048000,272.846000,232.176000Q273.158000,233.280000,273.158000,234.576000Q273.158000,236.352000,272.678000,237.576000Q272.198000,238.776000,271.430000,239.520000Q270.662000,240.264000,269.678000,240.600000Q268.718000,240.912000,267.734000,240.912000Q267.014000,240.912000,266.438000,240.768000Q265.886000,240.648000,265.454000,240.456000Q265.022000,240.264000,264.710000,240.048000Q264.422000,239.832000,264.254000,239.640000L264.158000,240.720000L262.190000,240.720000ZM267.446000,239.064000Q269.054000,239.064000,269.990000,238.008000Q270.950000,236.928000,270.950000,234.576000Q270.950000,233.664000,270.758000,232.896000Q270.566000,232.104000,270.158000,231.552000Q269.750000,230.976000,269.126000,230.664000Q268.526000,230.352000,267.686000,230.352000Q266.030000,230.352000,265.166000,231.504000Q264.302000,232.656000,264.302000,235.056000L264.302000,237.672000Q264.638000,238.128000,265.430000,238.608000Q266.246000,239.064000,267.446000,239.064000Z"
          />
        </g>
      </g>
    </g>
    <g transform="matrix(1.27707402803300 0 0 1.27707402803300 -135.85348004729036 -121.99491568571256)">
      <g transform="matrix(1 0 0 1 0.07761382500030 0.06641805000012)">
        <path
          fill="rgb(0,201,255)"
          transform="matrix(1 0 0 1 10.55200000000002 0)"
          d="M184.690000,168.960000C184.185000,169.173000,183.162000,169.812000,182.417000,170.380000C180.987000,171.471000,179.261000,171.742000,177.109000,171.214000C175.556000,170.833000,175.446000,171.282000,176.519000,173.615000C183.150000,188.035000,203.367000,188.511000,210.399000,174.414000C211.978000,171.249000,211.832000,170.694000,209.581000,171.316000C207.681000,171.840000,206.401000,171.543000,204.609000,170.159000C202.173000,168.278000,198.913000,168.276000,197.213000,170.155000C195.511000,172.036000,191.852000,171.948000,189.736000,169.977000C188.537000,168.859000,186.097000,168.368000,184.690000,168.960000"
        />
      </g>
      <path
        fillRule="evenodd"
        fill="rgb(152,162,174)"
        transform="matrix(1 0 0 1 10.55200000000002 0)"
        d="M183.880000,108.030000C182.975000,108.336000,180.383000,109.681000,178.119000,111.020000C174.266000,113.298000,167.106000,117.405000,163.002000,119.692000C154.092000,124.657000,150.780000,126.932000,149.402000,129.032000L148.002000,131.167000L148.002000,179.167000L149.497000,181.401000C150.478000,182.867000,151.646000,184.005000,152.897000,184.712000C153.945000,185.305000,155.072000,185.961000,155.402000,186.169000C156.829000,187.070000,162.284000,190.167000,162.443000,190.167000C162.539000,190.167000,163.379000,190.657000,164.310000,191.257000C165.241000,191.856000,166.378000,192.550000,166.837000,192.800000C171.955000,195.575000,173.293000,196.343000,173.833000,196.815000C174.181000,197.119000,174.573000,197.367000,174.706000,197.367000C174.918000,197.367000,184.217000,202.726000,185.802000,203.760000C190.866000,207.068000,195.086000,207.316000,200.002000,204.597000C201.762000,203.623000,203.562000,202.628000,204.002000,202.386000C204.442000,202.144000,205.573000,201.450000,206.515000,200.844000C207.457000,200.237000,208.987000,199.349000,209.915000,198.870000C210.843000,198.391000,213.172000,197.047000,215.090000,195.883000C217.008000,194.719000,218.661000,193.767000,218.762000,193.767000C218.864000,193.767000,221.614000,192.191000,224.874000,190.264000C228.135000,188.337000,231.446000,186.423000,232.233000,186.010000C235.260000,184.422000,236.849000,183.058000,238.102000,180.969000L239.402000,178.802000L239.398000,155.185000L239.394000,131.567000L238.210000,129.501000C237.558000,128.365000,236.345000,126.960000,235.513000,126.380000C233.718000,125.126000,223.946000,119.429000,218.402000,116.404000C217.962000,116.163000,217.332000,115.762000,217.002000,115.512000C216.672000,115.261000,215.502000,114.577000,214.402000,113.990000C213.302000,113.404000,212.049000,112.709000,211.617000,112.446000C202.831000,107.089000,200.603000,106.557000,198.619000,109.343000C197.827000,110.455000,197.802000,111.012000,197.802000,127.549000L197.802000,144.608000L199.302000,145.205000C203.837000,147.012000,204.578000,147.414000,207.187000,149.483000C209.492000,151.312000,214.000800,157.840700,214.000800,159.044700C214.000800,159.338700,213.654000,158.593970,213.963000,159.081000C216.050000,162.378000,215.532000,170.454000,212.910000,175.496000C201.150000,198.109000,167.417000,185.996000,172.764000,161.079000C174.197000,154.401000,182.896000,145.510000,187.890000,145.367000C189.849000,145.310900,189.802000,144.583000,189.802000,127.458000C189.802000,110.441000,189.769000,110.106000,187.943000,108.522000C186.824000,107.552000,185.697000,107.416000,183.880000,108.030000M185.457000,123.404000C185.469000,129.214000,185.461000,135.695000,185.440000,137.806000L185.402000,141.645000L182.424000,143.117000C158.291000,155.044000,166.727000,191.491000,193.602000,191.407000C220.979000,191.322000,229.072000,155.307000,204.515000,142.842000L202.002000,141.567000L202.002000,112.367000L202.981000,112.476000C203.519000,112.536000,204.239000,112.826000,204.581000,113.120000C204.922000,113.413000,206.436000,114.323000,207.945000,115.141000C209.453000,115.959000,211.841000,117.334000,213.252000,118.197000C214.662000,119.061000,215.887000,119.767000,215.975000,119.767000C216.231000,119.767000,228.987000,127.194000,231.574000,128.849000C235.811000,131.561000,235.587000,130.140000,235.696000,154.967000L235.791000,176.367000L234.866000,178.167000C233.953000,179.942000,232.343000,181.304000,229.202000,182.956000C227.541000,183.829000,226.700000,184.321000,225.004000,185.410000C224.453000,185.764000,222.922000,186.649000,221.602000,187.376000C217.875000,189.429000,217.201000,189.816000,210.802000,193.571000C207.502000,195.508000,204.082000,197.480000,203.202000,197.953000C202.322000,198.426000,200.144000,199.658000,198.363000,200.690000C193.439000,203.543000,193.350000,203.521000,182.003000,196.684000C181.563000,196.419000,180.769000,196.007000,180.239000,195.770000C179.710000,195.533000,178.486000,194.805000,177.519000,194.153000C176.553000,193.501000,175.626000,192.967000,175.460000,192.967000C175.294000,192.967000,174.268000,192.398000,173.180000,191.702000C171.072000,190.353000,163.795000,186.167000,163.558000,186.167000C163.481000,186.167000,162.465000,185.582000,161.300000,184.867000C160.135000,184.152000,158.827000,183.349000,158.392000,183.082000C157.958000,182.815000,156.832000,182.196000,155.891000,181.706000C154.950000,181.216000,153.690000,180.174000,153.091000,179.391000L152.002000,177.967000L152.002000,132.347000L152.912000,131.191000C153.756000,130.118000,158.031000,127.004000,158.695000,126.978000C158.856000,126.972000,160.164000,126.247000,161.602000,125.367000C163.040000,124.487000,164.310000,123.767000,164.425000,123.767000C164.540000,123.767000,165.122000,123.432000,165.718000,123.023000C166.848000,122.248000,176.531000,116.640000,180.002000,114.752000C181.102000,114.153000,182.272000,113.435000,182.602000,113.156000C183.346000,112.528000,184.696000,112.215000,185.119000,112.573000C185.293000,112.720000,185.445000,117.594000,185.457000,123.404000"
      />
    </g>
  </svg>
);
