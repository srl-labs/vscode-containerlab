/* =============================================================================
 * Free Text Markdown Styles
 * Styling for markdown content in free text annotations
 * ============================================================================= */

@layer components {
  .free-text-markdown {
    line-height: 1.5;
    word-wrap: break-word;
    overflow-wrap: break-word;
    white-space: normal !important;
    /* Overlay scrollbar so it doesn't affect layout width */
    scrollbar-gutter: stable;
  }

  .free-text-markdown::-webkit-scrollbar {
    width: 6px;
  }

  .free-text-markdown::-webkit-scrollbar-track {
    background: rgba(0, 0, 0, 0.2);
    border-radius: 3px;
  }

  .free-text-markdown::-webkit-scrollbar-thumb {
    background: rgba(255, 255, 255, 0.3);
    border-radius: 3px;
  }

  .free-text-markdown::-webkit-scrollbar-thumb:hover {
    background: rgba(255, 255, 255, 0.5);
  }

  .free-text-markdown p {
    margin: 0.5em 0;
  }

  .free-text-markdown > :first-child {
    margin-top: 0;
  }

  .free-text-markdown > :last-child {
    margin-bottom: 0;
  }

  /* Headings */
  .free-text-markdown h1,
  .free-text-markdown h2,
  .free-text-markdown h3,
  .free-text-markdown h4,
  .free-text-markdown h5,
  .free-text-markdown h6 {
    margin: 0.5rem 0 0.25rem 0;
    font-weight: 600;
    line-height: 1.3;
  }

  .free-text-markdown h1 { font-size: 1.5em; }
  .free-text-markdown h2 { font-size: 1.3em; }
  .free-text-markdown h3 { font-size: 1.15em; }
  .free-text-markdown h4 { font-size: 1em; }

  /* Code blocks */
  .free-text-markdown pre {
    margin: 0.5rem 0;
    padding: 0.5rem 0.75rem;
    border-radius: 0.375rem;
    overflow: auto;
    background-color: rgba(0, 0, 0, 0.45);
    font-size: 0.9em;
  }

  .free-text-markdown code {
    font-family: "Fira Code", "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;
    font-size: 0.9em;
  }

  .free-text-markdown :not(pre) > code {
    padding: 0.2em 0.4em;
    border-radius: 0.25rem;
    background-color: rgba(110, 118, 129, 0.4);
    color: #e6edf3;
  }

  /* Links */
  .free-text-markdown a {
    color: var(--vscode-textLink-foreground, #3794ff);
    text-decoration: underline;
    cursor: pointer;
  }

  .free-text-markdown a:hover {
    color: var(--vscode-textLink-activeForeground, #3794ff);
  }

  /* Horizontal rule */
  .free-text-markdown hr {
    border: 0;
    border-top: 1px solid rgba(255, 255, 255, 0.4);
    margin: 0.85rem 0;
  }

  /* Lists - compact spacing like GitHub */
  .free-text-markdown ul,
  .free-text-markdown ol {
    margin: 0 !important;
    padding: 0 0 0 1.25em !important;
    list-style-position: outside;
  }

  .free-text-markdown ul {
    list-style-type: disc;
  }

  .free-text-markdown ol {
    list-style-type: decimal;
  }

  .free-text-markdown li {
    margin: 0 !important;
    padding: 0 !important;
    line-height: 1.4;
  }

  .free-text-markdown li > p,
  .free-text-markdown li > * {
    margin: 0 !important;
  }

  .free-text-markdown li > p {
    display: inline;
  }

  /* Blockquotes */
  .free-text-markdown blockquote {
    border-left: 3px solid rgba(255, 255, 255, 0.35);
    margin: 0.75rem 0;
    padding-left: 0.75rem;
    color: var(--text-secondary, rgba(255, 255, 255, 0.7));
    font-style: italic;
  }

  /* Tables */
  .free-text-markdown table {
    width: 100%;
    border-collapse: collapse;
    margin: 0.5rem 0;
    font-size: 0.9em;
  }

  .free-text-markdown th,
  .free-text-markdown td {
    border: 1px solid rgba(255, 255, 255, 0.25);
    padding: 0.35rem 0.5rem;
    text-align: left;
  }

  .free-text-markdown th {
    background-color: rgba(255, 255, 255, 0.1);
    font-weight: 600;
  }

  /* Images */
  .free-text-markdown img {
    max-width: 100%;
    height: auto;
    border-radius: 0.25rem;
    vertical-align: middle;
  }

  /* Badge images (small height, like shields.io) should be inline */
  .free-text-markdown img[src*="shields.io"],
  .free-text-markdown img[src*="badge"],
  .free-text-markdown img[alt*="badge"],
  .free-text-markdown img[height],
  .free-text-markdown a > img {
    display: inline;
    vertical-align: middle;
    margin-right: 0.25em;
  }

  /* Links containing images should be inline */
  .free-text-markdown a:has(> img) {
    display: inline;
  }

  /* Paragraphs containing ONLY image links - make inline for badge rows */
  .free-text-markdown p:has(> a > img):not(:has(> :not(a))) {
    display: inline;
    margin: 0;
  }

  /* Add spacing after the last badge paragraph before regular content */
  .free-text-markdown p:has(> a > img) + p:not(:has(> a > img)) {
    margin-top: 0.75em;
  }

  /* Strong and emphasis */
  .free-text-markdown strong {
    font-weight: 700;
  }

  .free-text-markdown em {
    font-style: italic;
  }

  /* Strikethrough */
  .free-text-markdown del {
    text-decoration: line-through;
    opacity: 0.7;
  }

  /* Highlight.js syntax highlighting theme (dark) */
  .free-text-markdown .hljs {
    color: #abb2bf;
  }

  .free-text-markdown .hljs-comment,
  .free-text-markdown .hljs-quote {
    color: #5c6370;
    font-style: italic;
  }

  .free-text-markdown .hljs-keyword,
  .free-text-markdown .hljs-selector-tag,
  .free-text-markdown .hljs-addition {
    color: #c678dd;
  }

  .free-text-markdown .hljs-number,
  .free-text-markdown .hljs-string,
  .free-text-markdown .hljs-meta .hljs-meta-string,
  .free-text-markdown .hljs-literal,
  .free-text-markdown .hljs-doctag,
  .free-text-markdown .hljs-regexp {
    color: #98c379;
  }

  .free-text-markdown .hljs-title,
  .free-text-markdown .hljs-section,
  .free-text-markdown .hljs-name,
  .free-text-markdown .hljs-selector-id,
  .free-text-markdown .hljs-selector-class {
    color: #e06c75;
  }

  .free-text-markdown .hljs-attribute,
  .free-text-markdown .hljs-attr,
  .free-text-markdown .hljs-variable,
  .free-text-markdown .hljs-template-variable,
  .free-text-markdown .hljs-class .hljs-title,
  .free-text-markdown .hljs-type {
    color: #d19a66;
  }

  .free-text-markdown .hljs-symbol,
  .free-text-markdown .hljs-bullet,
  .free-text-markdown .hljs-subst,
  .free-text-markdown .hljs-meta,
  .free-text-markdown .hljs-meta .hljs-keyword,
  .free-text-markdown .hljs-selector-attr,
  .free-text-markdown .hljs-selector-pseudo,
  .free-text-markdown .hljs-link {
    color: #61aeee;
  }

  .free-text-markdown .hljs-built_in,
  .free-text-markdown .hljs-deletion {
    color: #e06c75;
  }

  .free-text-markdown .hljs-formula {
    background: #1e2227;
  }
}
